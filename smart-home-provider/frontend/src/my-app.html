<!--
@license
Copyright 2017, Google, Inc.
Licensed under the Apache License, Version 2.0 (the 'License');
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
    http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an 'AS IS' BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import" href="../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/iron-icons/places-icons.html">
<link rel="import" href="../bower_components/iron-list/iron-list.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-toast/paper-toast.html">
<link rel="stylesheet" href="https://code.jquery.com/qunit/qunit-2.3.3.css">
<link rel="import" href="smart-light.html">
<link rel="import" href="smart-thermostat.html">
<link rel="import" href="smart-scene.html">
<link rel="import" href="smart-camera.html">
<link rel="import" href="smart-vacuum.html">
<link rel="import" href="smart-washer.html">
<link rel="import" href="smart-refrigerator.html">

<dom-module id="my-app">
    <template>
        <style>
            :host {
                --app-primary-color: #4285f4;
                --app-secondary-color: black;
                display: block;
            }

            app-header {
                color: #fff;
                background-color: var(--app-primary-color);
            }

            app-header paper-icon-button {
                --paper-icon-button-ink-color: white;
            }

            #modal {
                width: 42%;
                display: -webkit-flex; /* Safari */
                -webkit-justify-content: space-around; /* Safari 6.1+ */
                display: flex;
                justify-content: space-around;
                overflow-y: scroll;
                padding: 24px 0px;
            }

            .square {
                height: 180px;
                width: 180px;
                margin: auto;
                background: none;
                border: none;
                outline: none;
            }

            .square:hover {
                background-color: rgb(238,238,238);
            }

            iron-icon {
                height:55%;
                width: 55%;
                color: #757575;
            }

            #close {
                height: 30px;
                width: 30px;
                margin-top: 0px;
                float: right;
            }

            #close > iron-icon {
                height: 100%;
                width: 100%;
                cursor: pointer;
                cursor: hand;
            }

            p {
                color: #757575;
                font-family: 'Roboto', 'Noto', sans-serif;
                font-size: 15px;
            }

            #no-devices-msg {
                width: 60%;
                margin: 20% auto;
            }

            #no-devices-msg > p {
                text-align: center;
            }

            #check {
                display: none;
            }

        </style>

        <!-- Main content -->
        <app-header condenses reveals effects="waterfall">
            <app-toolbar>
                <paper-icon-button id="account" icon="account-box" on-tap="_showAccount"></paper-icon-button>
                <div main-title>Smart Home Provider</div>
                <paper-icon-button id="add" icon="add"></paper-icon-button>
            </app-toolbar>
        </app-header>

        <paper-toast id="toast" text="Not signed in"></paper-toast>

        <paper-dialog id="progress-dialog">
            <p id="progress-dialog-content"></p>
        </paper-dialog>

        <paper-dialog id="modal" modal>
            <div id="close">
                <iron-icon icon="icons:close" dialog-confirm autofocus></iron-icon>
            </div>
            <div class="layout horizontal center-justified">
                <h1>Add a new device</h1>
                <button dialog-confirm autofocus class="square" id="lightSelector" on-tap="_addLight">
                    <iron-icon icon="image:wb-incandescent"></iron-icon>
                    <p>RGB Light</p>
                </button>
                <button dialog-confirm autofocus class="square" id="lightSelector" on-tap="_addMonochromeLight">
                    <iron-icon icon="image:wb-iridescent"></iron-icon>
                    <p>Monochrome Light</p>
                </button>
                <button dialog-confirm autofocus class="square" id="thermostatSelector" on-tap="_addThermostat">
                    <iron-icon icon="image:brightness-7"></iron-icon>
                    <p>Thermostat</p>
                </button>
                <button dialog-confirm autofocus class="square" id="sceneSelector" on-tap="_addScene">
                    <iron-icon icon="image:slideshow"></iron-icon>
                    <p>Scene</p>
                </button>
                <button dialog-confirm autofocus class="square" id="cameraSelector" on-tap="_addCamera">
                    <iron-icon icon="image:camera-alt"></iron-icon>
                    <p>Camera</p>
                </button>
                <button dialog-confirm autofocus class="square" id="vacuumSelector" on-tap="_addVacuum">
                    <iron-icon icon="hardware:router"></iron-icon>
                    <p>Vacuum</p>
                </button>
                <button dialog-confirm autofocus class="square" id="washerSelector" on-tap="_addWasher">
                    <iron-icon icon="icons:save"></iron-icon>
                    <p>Washer</p>
                </button>
                <button dialog-confirm autofocus class="square" id="refrigeratorSelector" on-tap="_addRefrigerator">
                    <iron-icon icon="places:kitchen"></iron-icon>
                    <p>Refrigerator</p>
                </button>
            </div>
        </paper-dialog>

        <div id="no-devices-msg" hidden="[[hide]]">
            <p class="layout horizontal center-justified">
                You currently don't have any devices set up. To set up a device, click the "+" button and take it online.
            </p>
        </div>

        <iron-list id="light-list" items="[[lights]]" as="item" grid>
            <template>
                <div class="item">
                    <smart-light device=[[item]]></smart-light>
                </div>
            </template>
        </iron-list>

        <iron-list id="thermostat-list" items="[[thermostats]]" as="item" grid>
            <template>
                <div class="item">
                    <smart-thermostat device=[[item]]></smart-thermostat>
                </div>
            </template>
        </iron-list>

        <iron-list id="scene-list" items="[[scenes]]" as="item" grid>
            <template>
                <div class="item">
                    <smart-scene device=[[item]]></smart-scene>
                </div>
            </template>
        </iron-list>

        <iron-list id="camera-list" items="[[cameras]]" as="item" grid>
            <template>
                <div class="item">
                    <smart-camera device=[[item]]></smart-camera>
                </div>
            </template>
        </iron-list>

        <iron-list id="vacuum-list" items="[[vacuums]]" as="item" grid>
            <template>
                <div class="item">
                    <smart-vacuum device=[[item]]></smart-vacuum>
                </div>
            </template>
        </iron-list>

        <iron-list id="washer-list" items="[[washers]]" as="item" grid>
            <template>
                <div class="item">
                    <smart-washer device=[[item]]></smart-washer>
                </div>
            </template>
        </iron-list>

        <iron-list id="refrigerator-list" items="[[refrigerators]]" as="item" grid>
            <template>
                <div class="item">
                    <smart-refrigerator device=[[item]]></smart-refrigerator>
                </div>
            </template>
        </iron-list>
    </template>

    <script>
        var nextDeviceId = 0;

        function getNextDeviceId() {
            return nextDeviceId++;
        };

        class MyApp extends Polymer.Element {
            static get is() { return 'my-app' }

            static get properties() {
                return {
                    hide: {
                        type: Boolean,
                        value: false
                    },
                    deviceCount: {
                        type: Number,
                        value: 0
                    },
                    lights: {
                        type: Array,
                        value: []
                    },
                    thermostats: {
                        type: Array,
                        value: []
                    },
                    scenes: {
                        type: Array,
                        value: []
                    },
                    cameras: {
                        type: Array,
                        value: []
                    },
                    vacuums: {
                        type: Array,
                        value: []
                    },
                    washers: {
                        type: Array,
                        value: []
                    },
                    locks: {
                        type: Array,
                        value: []
                    },
                    refrigerators: {
                        type: Array,
                        value: []
                    }
                }
            }

            connectedCallback() {
                super.connectedCallback();
                // Reset all user devices
                window.requestAnimationFrame(() => {
                    this.$.add.addEventListener('click', e => this.$.modal.open());
                    this._auth()
                        .then(() => {
                            const options = {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                    'Authorization': 'Bearer ' + AUTH_TOKEN
                                }
                            };
                            return fetch(SMART_HOME_PROVIDER_CLOUD_ENDPOINT + '/reset-devices', options)
                        });
                });
            }

            showProgress(message) {
                this.$['progress-dialog-content'].innerHTML = message || 'no message';
                this.$['progress-dialog'].show();
            }

            hideProgress() {
                this.$['progress-dialog'].close();
            }

            showNoDeviceMessage() {
                this.hide = false;
            }

            hideNoDeviceMessage() {
                this.hide = true;
            }

            removeDevice(type, index) {
                this.splice(type, index, 1);
                this.hide = --this.deviceCount > 0;
            }

            showToast(toastmsg) {
                this.$.toast.text = toastmsg;
                this.$.toast.open();
            }

            _showAccount() {
                this.$.toast.text = `Welcome ${window.USERNAME}`;
                this.$.toast.open();
            }

            _refresh() {
                const options = {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + AUTH_TOKEN
                    }
                };

                return fetch(SMART_HOME_PROVIDER_CLOUD_ENDPOINT + '/status', options)
                    .then(function(response) {
                        return response.json();
                    }).then(function(json) {
                        const uid = json.uid;
                        delete json.uid;
                        for (const key in json) {
                            devices[key] = json[key];
                        }
                        console.log(devices);
                        return app._handleRefresh(app, uid);
                    });
            }

            _handleRefresh(app, uid) {
                if (Object.keys(devices).length == 0) {
                    console.log("no devices");
                } else {
                    for (const id of Object.keys(devices)) {
                        devices[id].id = id;
                        delete devices[id].properties.id;
                        devices[id].states.on = false;
                        devices[id].states.online = false;
                        switch(devices[id].properties.type) {
                            case 'action.devices.types.LIGHT':
                                app._addLight(null, devices[id]);
                                break;
                            case 'action.devices.types.THERMOSTAT':
                                app._addThermostat(null, devices[id]);
                                break;
                            case 'action.devices.types.SCENE':
                                app._addScene(null, devices[id]);
                                break;
                            case 'action.devices.types.CAMERA':
                                app._addCamera(null, devices[id]);
                                break;
                            case 'action.devices.types.VACUUM':
                                devices[id].states.isRunning = false;
                                devices[id].states.isPaused = false;
                                app._addVacuum(null, devices[id]);
                                break;
                            case 'action.devices.types.WASHER':
                                devices[id].states.isRunning = false;
                                devices[id].states.isPaused = false;
                                app._addWasher(null, devices[id]);
                                break;
                            case 'action.devices.types.REFRIGERATOR':
                                app._addRefrigerator(null, devices[id]);
                                break;
                            default:
                                break;
                        }
                        nextDeviceId = parseInt(id)+1;
                    }
                }
                return app;
            }

            _auth() {
                const options = {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + AUTH_TOKEN
                    }
                };
                return fetch(SMART_HOME_PROVIDER_CLOUD_ENDPOINT + '/auth', options)
                    .then(fetch(SMART_HOME_PROVIDER_CLOUD_ENDPOINT + '/status', options));
            }

            _getNickname(nicknames, typeSize, id) {
                if (nicknames && typeSize < nicknames.length) {
                    return nicknames[typeSize];
                } else {
                    return `smart device ${id}`;
                }
            }

            _createDevice(device) {
                this.hideNoDeviceMessage();
                this.deviceCount++;
                // If the device variable exists, resolve to use it
                if (device && device.hasOwnProperty('id')) {
                    return Promise.resolve(device);
                }
                // Otherwise reject the variable and create a new one
                return Promise.reject(getNextDeviceId());
            }

            _showDevice(deviceType) {
                window.requestAnimationFrame(() => {
                    this.$[`${deviceType}-list`].fire('iron-resize');
                });
            }

            _addDevice(type, device) {
                this.push(type, device);
            }

            _addLight(event, light) {
                this._createDevice(light)
                    .then(device => {
                        this._addDevice('lights', device);
                    })
                    .catch((lightId) => {
                        const nicknames = ['table lamp', 'reading lamp', 'doorway', 'stairway'];
                        const light = {
                            id: String(lightId),
                            properties: {
                                type: 'action.devices.types.LIGHT',
                                traits: [
                                    'action.devices.traits.OnOff',
                                    'action.devices.traits.Brightness',
                                    'action.devices.traits.ColorSpectrum'
                                ],
                                name: {
                                    defaultNames: ['Smart Light'],
                                    name: 'Smart Light ' + lightId,
                                    nicknames: [this._getNickname(nicknames, this.lights.length, lightId)]
                                },
                                willReportState: false,
                                roomHint: '',
                                deviceInfo: {
                                    manufacturer: 'Smart Home Provider',
                                    model: 'g1337',
                                    swVersion: '1.0.11',
                                    hwVersion: '1.1'
                                },
                                customData: {
                                    smartHomeProviderId: 'FkldJVJCmDNSaoLkoq0txiz8Byf2Hr'
                                }
                            },
                            willReportState: false,
                            roomHint: '',
                            deviceInfo: {
                                manufacturer: 'Smart Home Provider',
                                model: 'g1337',
                                swVersion: '1.0.11',
                                hwVersion: '1.1'
                            },
                            customData: {
                                smartHomeProviderId: 'FkldJVJCmDNSaoLkoq0txiz8Byf2Hr'
                            },
                            states: {
                                on: false,
                                online: true,
                                brightness: 80,
                                color: {
                                    name: 'cerulean',
                                    spectrumRGB: 31655
                                }
                            }
                        };
                        this._addDevice('lights', light);
                    })
                this._showDevice('light');
            }

            _addMonochromeLight(event, light) {
                this._createDevice(light)
                    .then(device => {
                        this._addDevice('lights', device);
                    })
                    .catch((lightId) => {
                        const nicknames = ['table lamp', 'reading lamp', 'doorway', 'stairway'];
                        const light = {
                            id: String(lightId),
                            properties: {
                                type: 'action.devices.types.LIGHT',
                                traits: [
                                    'action.devices.traits.OnOff',
                                    'action.devices.traits.Brightness',
                                    'action.devices.traits.ColorTemperature'
                                ],
                                attributes: {
                                    'temperatureMinK': 2000,
                                    'temperatureMaxK': 6500
                                },
                                name: {
                                    defaultNames: ['Smart Light'],
                                    name: 'Smart Light ' + lightId,
                                    nicknames: [this._getNickname(nicknames, this.lights.length, lightId)]
                                },
                                willReportState: false,
                                roomHint: '',
                                deviceInfo: {
                                    manufacturer: 'Smart Home Provider',
                                    model: 'h1337',
                                    swVersion: '1.0.9',
                                    hwVersion: '1.0'
                                },
                                customData: {
                                    smartHomeProviderId: 'FkldJVJCmDNSaoLkoq0txiz8Byf2Hr'
                                }
                            },
                            name: {
                                defaultNames: ['Smart Light'],
                                name: 'Smart Light ' + lightId,
                                nicknames: [ this._getNickname(nicknames, this.lights.length, lightId) ]
                            },
                            willReportState: false,
                            roomHint: '',
                            deviceInfo: {
                                manufacturer: 'Smart Home Provider',
                                model: 'h1337',
                                swVersion: '1.0.9',
                                hwVersion: '1.0'
                            },
                            customData: {
                                smartHomeProviderId: 'FkldJVJCmDNSaoLkoq0txiz8Byf2Hr'
                            },
                            states: {
                                on: false,
                                online: true,
                                brightness: 80,
                                color: {
                                    name: 'soft white',
                                    temperature: 2700
                                }
                            }
                        };
                        this._addDevice('lights', light);
                    })
                this._showDevice('light');
            }

            _addThermostat(event, thermostat) {
                this._createDevice(thermostat)
                    .then(device => {
                        this._addDevice('thermostats', device);
                    })
                    .catch((thermostatId) => {
                        const nicknames = ['wall thermostat', 'upstairs thermostat']
                        const thermostat = {
                            id: String(thermostatId),
                            properties: {
                                type: 'action.devices.types.THERMOSTAT',
                                traits: [
                                    'action.devices.traits.TemperatureSetting'
                                ],
                                name: {
                                    defaultNames: ['Smart Thermostat'],
                                    name: 'Smart Thermostat ' + thermostatId,
                                    nicknames: [this._getNickname(nicknames, this.thermostats.length, thermostatId)]
                                },
                                willReportState: false,
                                roomHint: 'hallway',
                                deviceInfo: {
                                    manufacturer: 'Smart Home Provider',
                                    model: 'g1338',
                                    swVersion: '1.0.31',
                                    hwVersion: '1.1'
                                },
                                attributes: {
                                    availableThermostatModes: 'off,heat,cool,on',
                                    thermostatTemperatureUnit: 'C'
                                },
                                customData: {
                                    smartHomeProviderId: 'SGs84HiURHSb6ggrGjiv9jJ3t7U4ze'
                                }
                            },
                            customData: {
                                smartHomeProviderId: 'SGs84HiURHSb6ggrGjiv9jJ3t7U4ze'
                            }
                        };
                        this._addDevice('thermostats', thermostat);
                    })
                this._showDevice('thermostat');
            }

            _addScene(event, scene) {
                this._createDevice(scene)
                    .then(device => {
                        this._addDevice('scenes', device);
                    })
                    .catch((sceneId) => {
                        const scene = {
                            id: String(sceneId),
                            properties: {
                                type: 'action.devices.types.SCENE',
                                traits: [
                                    'action.devices.traits.Scene'
                                ],
                                name: {
                                    defaultNames: [],
                                    name: 'Smart Scene ' + sceneId,
                                    nicknames: [this._getNickname(undefined, this.scenes.length, sceneId)]
                                },
                                willReportState: false,
                                attributes: {
                                    sceneReversible: true
                                },
                                deviceInfo: {
                                    manufacturer: 'Smart Home Provider',
                                    model: 'g1339',
                                    swVersion: '1.0.31',
                                    hwVersion: '1.1'
                                },
                                customData: {
                                    smartHomeProviderId: 'fiGgZ0vrhFRgwf5XJkna2GRwO8z80J'
                                }
                            },
                            willReportState: false,
                            attributes: {
                                sceneReversible: true
                            },
                             deviceInfo: {
                                manufacturer: 'Smart Home Provider',
                                model: 'g1339',
                                swVersion: '1.0.31',
                                hwVersion: '1.1'
                            },
                            customData: {
                                smartHomeProviderId: 'fiGgZ0vrhFRgwf5XJkna2GRwO8z80J'
                            }
                        };
                        this._addDevice('scenes', scene);
                    })
                this._showDevice('scene');
            }

            _addCamera(event, camera) {
                this._createDevice(camera)
                    .then(device => {
                        this._addDevice('cameras', device);
                    })
                    .catch((cameraId) => {
                        const nicknames = ['backyard camera', 'security camera'];
                        const camera = {
                            id: String(cameraId),
                            properties: {
                                type: 'action.devices.types.CAMERA',
                                traits: [
                                    'action.devices.traits.CameraStream'
                                ],
                                name: {
                                    defaultNames: ['Smart Camera ' + cameraId],
                                    name: 'Smart Camera ' + cameraId,
                                    nicknames: [this._getNickname(nicknames, this.cameras.length, cameraId)]
                                },
                                willReportState: false,
                                attributes: {
                                    'cameraStreamSupportedProtocols': ["mp4", "hls"]
                                },
                                deviceInfo: {
                                    manufacturer: 'Smart Home Provider',
                                    model: 'g1340',
                                    swVersion: '1.0.31',
                                    hwVersion: '1.1'
                                },
                                customData: {
                                    smartHomeProviderId: 'fiGgZ0vrhFRgwf5XJkna2GRwO8z80J'
                                }
                            },
                             deviceInfo: {
                                manufacturer: 'Smart Home Provider',
                                model: 'g1340',
                                swVersion: '1.0.31',
                                hwVersion: '1.1'
                            },
                            customData: {
                                smartHomeProviderId: 'fiGgZ0vrhFRgwf5XJkna2GRwO8z80J'
                            }
                        };
                        this._addDevice('cameras', camera);
                    })
                this._showDevice('camera');
            }

            _addVacuum(event, vacuum) {
                this._createDevice(vacuum)
                    .then(device => {
                        this._addDevice('vacuums', device);
                    })
                    .catch((vacuumId) => {
                        const nicknames = ['kitchen vacuum', 'robo vacuum'];
                        const vacuum = {
                            id: String(vacuumId),
                            properties: {
                                type: 'action.devices.types.VACUUM',
                                traits: [
                                    'action.devices.traits.OnOff',
                                    'action.devices.traits.StartStop',
                                    'action.devices.traits.Modes',
                                    'action.devices.traits.Toggles',
                                    'action.devices.traits.Dock'
                                ],
                                name: {
                                    defaultNames: ['Smart Vacuum'],
                                    name: 'Smart Vacuum ' + vacuumId,
                                    nicknames: [this._getNickname(nicknames, this.vacuums.length, vacuumId)]
                                },
                                willReportState: false,
                                attributes: {
                                availableToggles: [{
                                        name: "quiet",
                                        name_values: [{
                                            name_synonym: ["quiet", "silent"],
                                            lang: "ENGLISH"
                                        }, {
                                            name_synonym: ["ruhig", "still"],
                                            lang: "GERMAN"
                                        }]
                                    }],
                                    availableModes: [{
                                        name: "speed",
                                        name_values: [{
                                            name_synonym: ["speed", "velocity"],
                                            lang: "ENGLISH"
                                        }],
                                        settings: [{
                                            setting_name: "slow",
                                            setting_values: [{
                                                setting_synonym: ["slow", "sluggish"]
                                            }]
                                        }, {
                                            setting_name: "fast",
                                            setting_values: [{
                                                setting_synonym: ["fast", "quick"]
                                            }]
                                        }]
                                    }],
                                    pausable: false
                                },
                                roomHint: '',
                                deviceInfo: {
                                    manufacturer: 'Smart Home Provider',
                                    model: 'g1400',
                                    swVersion: '1.0.11',
                                    hwVersion: '1.0'
                                },
                                customData: {
                                    smartHomeProviderId: 'FkldJVJCmDNSaoLkoq0txiz8Byf2Hr'
                                },
                                states: {
                                    on: false,
                                    online: true,
                                    isRunning: false,
                                    isPaused: false,
                                    currentModeSettings: {
                                        speed: "slow"
                                    },
                                    currentToggleSettings: {
                                        quiet: false
                                    }
                                }
                            }
                        };
                        this._addDevice('vacuums', vacuum);
                    })
                this._showDevice('vacuum');
            }

            _addWasher(event, washer) {
                this._createDevice(washer)
                    .then(device => {
                        this._addDevice('washers', device);
                    })
                    .catch((washerId) => {
                        const nicknames = ['washing machine', 'acme washer']
                        const washer = {
                            id: String(washerId),
                            properties: {
                                type: 'action.devices.types.WASHER',
                                traits: [
                                    'action.devices.traits.OnOff',
                                    'action.devices.traits.StartStop',
                                    'action.devices.traits.Modes',
                                    'action.devices.traits.Toggles',
                                    'action.devices.traits.RunCycle'
                                ],
                                name: {
                                    defaultNames: ['Smart Washer'],
                                    name: 'Smart Washer ' + washerId,
                                    nicknames: [this._getNickname(nicknames, this.washers.length, washerId)]
                                },
                                willReportState: false,
                                attributes: {
                                    availableModes: [
                                        {
                                            name: "load",
                                            name_values: [{
                                                name_synonym: ["load", "size", "load size"],
                                                lang: "ENGLISH"
                                            }],
                                            settings: [{
                                                setting_name: "small",
                                                setting_values: [{
                                                    setting_synonym: ["small", "half"],
                                                    lang: "ENGLISH"
                                                }]
                                            }, {
                                                setting_name: "large",
                                                setting_values: [{
                                                    setting_synonym: ["large", "full"],
                                                    lang: "ENGLISH"
                                                }]
                                            }],
                                            ordered: true
                                        }
                                    ],
                                    availableToggles: [
                                        {
                                        name: "extra rinse",
                                        name_values: [{
                                            name_synonym: ["extra", "rinse"],
                                            lang: "ENGLISH" }]
                                        }, {
                                        name: "permanent press",
                                        name_values: [{
                                            name_synonym: ["permanent", "press"],
                                            lang: "ENGLISH" }]
                                        },
                                    ],
                                    pausable: true
                                },
                                roomHint: '',
                                deviceInfo: {
                                    manufacturer: 'Smart Home Provider',
                                    model: 'g1401',
                                    swVersion: '1.0.11',
                                    hwVersion: '1.0'
                                },
                                customData: {
                                    smartHomeProviderId: 'FkldJVJCmDNSaoLkoq0txiz8Byf2Hr'
                                }
                            }
                        };
                        this._addDevice('washers', washer);
                    })
                this._showDevice('washer');
            }

            _addLock(event, lock) {
                this._createDevice(lock)
                    .then(device => {
                        this._addDevice('locks', device);
                    })
                    .catch((lockId) => {
                        const nicknames = ['front door', 'bay window'];
                        const lock = {
                            id: String(lockId),
                            properties: {
                                type: 'action.devices.types.LOCK',
                                traits: [
                                    'action.devices.traits.LockUnlock'
                                ],
                                name: {
                                    defaultNames: ['Smart Lock'],
                                    name: 'Smart Lock ' + lockId,
                                    nicknames: [this._getNickname(nicknames, this.locks.length, lockId)]
                                },
                                willReportState: false,
                                roomHint: '',
                                deviceInfo: {
                                    manufacturer: 'Sirius Cybernetics Corporation',
                                    model: '492134',
                                    swVersion: '11.4',
                                    hwVersion: '3.2'
                                },
                                customData: {
                                    smartHomeProviderId: 'FkldJVJCmDNSaoLkoq0txiz8Byf2Hr'
                                }
                            },
                            currentToggleSettings: {
                                extraRinse: false,
                                permanentPress: false
                            }
                        };
                        this._addDevice('locks', lock);
                    })
                this._showDevice('lock');
            }

            _addRefrigerator(event, refrigerator) {
                this._createDevice(refrigerator)
                    .then(device => {
                        this._addDevice('refrigerators', device);
                    })
                    .catch((refrigeratorId) => {
                        const nicknames = ['kitchen refrigerator', 'mini-fridge', 'garage freezer'];
                        const refrigerator = {
                            id: String(refrigeratorId),
                            properties: {
                                type: 'action.devices.types.REFRIGERATOR',
                                traits: [
                                    'action.devices.traits.OnOff',
                                    'action.devices.traits.Toggles'
                                ],
                                attributes: {
                                    availableToggles: [{
                                        name: "quiet",
                                        name_values: [{
                                            name_synonym: ["quiet", "silent"],
                                            lang: "en"
                                        }]
                                    }]
                                },
                                name: {
                                    defaultNames: ['Smart Fridge'],
                                    name: 'Smart Refrigerator ' + refrigeratorId,
                                    nicknames: [this._getNickname(nicknames, this.refrigerators.length, refrigeratorId)]
                                },
                                willReportState: false,
                                roomHint: '',
                                deviceInfo: {
                                    manufacturer: 'Sirius Cybernetics Corporation',
                                    model: '2331B',
                                    swVersion: '11.4',
                                    hwVersion: '11.2'
                                },
                                customData: {
                                    smartHomeProviderId: 'FkldJVJCmDNSaoLkoq0txiz8Byf2Hr'
                                }
                            },
                            states: {
                                on: false,
                                online: true,
                                currentToggleSettings: {
                                    quiet: false
                                }
                            }
                        };
                    });
                    this._showDevice('refrigerator');
                }
        }

        customElements.define(MyApp.is, MyApp);
    </script>
</dom-module>